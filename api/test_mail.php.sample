<?php
/**
 * Mail GÃ¶nderim Test DosyasÄ±
 * Bu dosyayÄ± tarayÄ±cÄ±da aÃ§arak mail ayarlarÄ±nÄ±zÄ± test edebilirsiniz
 * Ã–rnek: https://vivarel.com.tr/api/test_mail.php
 */

header('Content-Type: text/html; charset=UTF-8');

require_once __DIR__ . '/PHPMailer.php';
$config = require __DIR__ . '/smtp_config.php';

echo "<h1>ğŸ“§ Mail GÃ¶nderim Testi</h1>";
echo "<p>SMTP AyarlarÄ±:</p>";
echo "<ul>";
echo "<li><strong>Host:</strong> {$config['smtp_host']}</li>";
echo "<li><strong>Port:</strong> {$config['smtp_port']}</li>";
echo "<li><strong>Secure:</strong> {$config['smtp_secure']}</li>";
echo "<li><strong>Username:</strong> {$config['smtp_username']}</li>";
echo "<li><strong>From:</strong> {$config['from_email']}</li>";
echo "</ul>";

echo "<hr>";

try {
    $mail = new PHPMailer();
    
    // SMTP ayarlarÄ±
    $mail->Host = $config['smtp_host'];
    $mail->Port = $config['smtp_port'];
    $mail->SMTPAuth = $config['smtp_auth'];
    $mail->Username = $config['smtp_username'];
    $mail->Password = $config['smtp_password'];
    $mail->SMTPSecure = $config['smtp_secure'];
    
    // Mail iÃ§eriÄŸi
    $mail->From = $config['from_email'];
    $mail->FromName = $config['from_name'];
    $mail->Subject = "Test Mail - " . date('d.m.Y H:i:s');
    $mail->Body = "<h2>Test Mail</h2><p>Bu bir test mailidir. Mail sisteminiz Ã§alÄ±ÅŸÄ±yor! âœ…</p>";
    $mail->isHTML = true;
    $mail->CharSet = 'UTF-8';
    
    // AlÄ±cÄ±
    $mail->addAddress($config['to_email']);
    
    // GÃ¶nder
    $ok = $mail->send();
    
    if ($ok) {
        echo "<div style='background:#d1fae5;padding:16px;border-radius:8px;color:#065f46'>";
        echo "<h2>âœ… BaÅŸarÄ±lÄ±!</h2>";
        echo "<p>Test maili <strong>{$config['to_email']}</strong> adresine gÃ¶nderildi.</p>";
        echo "<p>LÃ¼tfen gelen kutunuzu kontrol edin.</p>";
        echo "</div>";
    } else {
        echo "<div style='background:#fee2e2;padding:16px;border-radius:8px;color:#991b1b'>";
        echo "<h2>âŒ Hata!</h2>";
        echo "<p>Mail gÃ¶nderilemedi. SMTP ayarlarÄ±nÄ±zÄ± kontrol edin.</p>";
        echo "</div>";
    }
} catch (Exception $e) {
    echo "<div style='background:#fee2e2;padding:16px;border-radius:8px;color:#991b1b'>";
    echo "<h2>âŒ Hata!</h2>";
    echo "<p><strong>Hata MesajÄ±:</strong> " . htmlspecialchars($e->getMessage()) . "</p>";
    echo "<p>LÃ¼tfen smtp_config.php dosyasÄ±ndaki ayarlarÄ± kontrol edin.</p>";
    echo "</div>";
}

echo "<hr>";
echo "<h3>ğŸ“ YapÄ±lacaklar:</h3>";
echo "<ol>";
echo "<li>Hosting control panel'den SMTP bilgilerinizi Ã¶ÄŸrenin</li>";
echo "<li><code>api/smtp_config.php</code> dosyasÄ±nÄ± dÃ¼zenleyin</li>";
echo "<li>SMTP ÅŸifresini doÄŸru girdiÄŸinizden emin olun</li>";
echo "<li>Bu sayfayÄ± tekrar yÃ¼kleyin</li>";
echo "</ol>";

echo "<hr>";
echo "<p style='color:#6b7280;font-size:12px'>Test tamamlandÄ±. Bu dosyayÄ± canlÄ±ya aldÄ±ktan sonra silebilirsiniz.</p>";
?>
